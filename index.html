<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>VHS Landing Page</title>
<link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">

<style>
  html, body {
    margin: 0; padding: 0;
    width: 100%; height: 100%;
    overflow: hidden;
    font-family: 'VT323', monospace;
    color: #ddd;
    position: relative;
  }

  /* Fullscreen responsive video background */
  #bg-video {
    position: fixed;
    top: 50%; left: 50%;
    min-width: 100%; min-height: 100%;
    transform: translate(-50%, -50%);
    object-fit: cover;
    z-index: -2;
    pointer-events: none;
  }

  #overlay-glow {
    position: fixed; top:0; left:0; width:100%; height:100%;
    background: rgba(0,0,0,0.3);
    mix-blend-mode: multiply;
    z-index: -1;
  }

  #start-screen {
    position: absolute; width:100%; height:100%;
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
    z-index: 2; text-align: center;
  }

  h2 {
    font-size: 6em; letter-spacing: 4px;
    text-shadow: 0 0 5px #ddd, 0 0 10px #ddd;
    margin-bottom: 20px;
    animation: flickerText 1.5s infinite;
    text-transform: uppercase;
  }

  .menu { display: flex; flex-wrap: wrap; justify-content: center; }
  .menu button {
    font-size: 2em;; font-family: 'VT323', monospace;
    margin: 10px; padding: 12px 50px;
    background: transparent; border: none;
    color: #ddd; cursor: pointer;
    text-shadow: 0 0 3px #ddd;
    transition: all .12s ease-in-out;
  }

  .menu button:hover {
    font-weight: bold;
    animation: flickerButton .25s infinite;
    text-shadow: 0 0 3px #fff, 0 0 8px #aaa;
  }

  @keyframes flickerButton {
    0%{opacity:1}25%{opacity:.93}50%{opacity:.95}75%{opacity:.92}100%{opacity:1}
  }

  #room3D { display:none; width:100%; height:100%; }

  @keyframes flickerText{
    0%,100%{opacity:1}10%{opacity:.8}30%{opacity:.85}50%{opacity:1}
  }

  #loading{
    position:absolute;top:20px;left:20px;
    color:lime;background:#000c;
    padding:15px;border-radius:6px;display:none;z-index:100
  }

  #status{
    position:absolute;bottom:20px;left:20px;
    color:white;background:#000b;
    padding:10px;border-radius:6px;
    display:none;z-index:100
  }

  .progress-bar{width:300px;height:20px;background:#333;margin-top:10px;border-radius:10px;overflow:hidden}
  .progress-fill{height:100%;background:linear-gradient(90deg,#0f0,#0c0);width:0%;transition:width .25s}

  @media(max-width:768px){h2{font-size:3em}.menu button{font-size:1.5em;padding:10px 30px}}
  @media(max-width:480px){h2{font-size:2.2em}.menu button{font-size:1.2em;padding:8px 20px}}
</style>
</head>

<body>

<!-- VHS video background -->
<video id="bg-video" autoplay muted loop>
  <source src="Blank VHS Tape with Play Overlay Footage _ Free Download.mp4" type="video/mp4">
</video>
<div id="overlay-glow"></div>

<!-- Landing screen -->
<div id="start-screen">
  <h2>YIJUN RECORDS</h2>
  <div class="menu">
    <button onclick="start3DWalkthrough()">PRESS TO START</button>
    <button>RESUME</button>
    <button>STORY</button>
    <button>SETTINGS</button>
  </div>
</div>

<!-- 3D room -->
<div id="room3D"></div>

<!-- Loading + status -->
<div id="loading">
  <div id="loading-text">Initializingâ€¦</div>
  <div class="progress-bar"><div id="progress-fill" class="progress-fill"></div></div>
</div>
<div id="status">Click to look around â€¢ WASD to move</div>

<!-- Static sound -->
<audio id="static-sound" loop>
  <source src="static.mp3" type="audio/mp3">
</audio>

<!-- THREE.JS -->
<script type="module">
import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js';
import { GLTFLoader } from 'https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/loaders/GLTFLoader.js';
import { PointerLockControls } from 'https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/controls/PointerLockControls.js';

const staticAudio = document.getElementById("static-sound");
staticAudio.volume = 0.25;

let scene, camera, renderer, controls;

const loadingDiv = document.getElementById('loading');
const loadingText = document.getElementById('loading-text');
const progressFill = document.getElementById('progress-fill');
const statusDiv = document.getElementById('status');

function updateLoading(text, percent=0){
  loadingText.textContent=text;
  progressFill.style.width=percent+'%';
}

function start3DWalkthrough(){
  document.getElementById('start-screen').style.display='none';
  document.getElementById('bg-video').style.display='none';
  document.getElementById('overlay-glow').style.display='none';

  // ðŸ”Š user-click triggered audio (works on all browsers)
  staticAudio.currentTime = 0;
  staticAudio.play().catch(()=>console.log("Audio blocked"));

  document.getElementById('room3D').style.display='block';
  loadingDiv.style.display='block';
  statusDiv.style.display='block';

  updateLoading("Initializing 3D engineâ€¦", 10);
  setTimeout(init3D,100);
}

function init3D(){
  scene = new THREE.Scene();
  scene.background = new THREE.Color(0x000000);

  camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, .1, 1000);
  camera.position.set(0,1.6,5);

  renderer = new THREE.WebGLRenderer({antialias:true});
  renderer.setSize(window.innerWidth, window.innerHeight);
  renderer.setPixelRatio(Math.min(window.devicePixelRatio,2));
  document.getElementById('room3D').appendChild(renderer.domElement);

  const ambient = new THREE.AmbientLight(0xffffff,.6);
  const dir = new THREE.DirectionalLight(0xffffff,.9);
  dir.position.set(10,20,12);
  scene.add(ambient,dir);

  controls = new PointerLockControls(camera, renderer.domElement);
  renderer.domElement.addEventListener('click',()=>controls.lock());

  updateLoading("Loading modelâ€¦",40);
  loadModel();

  window.addEventListener('resize',onResize);
  animate();
}

function loadModel(){
  const loader = new GLTFLoader();

  loader.load(
    'backrooms_again.glb',     // <<< make sure file is next to this HTML

    (gltf)=>{
      updateLoading("Model loaded!",100);

      const model = gltf.scene;
      model.scale.set(1,1,1);
      scene.add(model);

      setTimeout(()=>loadingDiv.style.display='none',900);
    },

    (xhr)=>{
      const p = xhr.total ? (xhr.loaded/xhr.total)*100 : 0;
      updateLoading(`Loading modelâ€¦ ${Math.round(p)}%`,50+p*.4);
    },

    (err)=>{
      console.error(err);
      updateLoading("Model failed â€” using fallback.",90);
      createFallback();
    }
  );
}

function createFallback(){
  const floor = new THREE.Mesh(
    new THREE.PlaneGeometry(50,50),
    new THREE.MeshStandardMaterial({color:0xffffcc,roughness:.9})
  );
  floor.rotation.x=-Math.PI/2; floor.position.y=-.5;
  scene.add(floor);
}

function onResize(){
  camera.aspect=window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth,window.innerHeight);
}

function animate(){
  requestAnimationFrame(animate);
  renderer.render(scene,camera);
}
</script>

</body>
</html>
